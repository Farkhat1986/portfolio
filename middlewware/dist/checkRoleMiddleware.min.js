"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkRoleMiddleware=checkRoleMiddleware;var _jsonwebtoken=_interopRequireDefault(require("jsonwebtoken")),_dotenv=require("dotenv");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(0,_dotenv.config)();var secret=process.env.SECRET_KEY;function checkRoleMiddleware(n){return function(e,t,r){"OPTIONS"===e.method&&r();try{var o=e.headers.authorization.split(" ")[1];if(!o)return t.status(401).json({message:"НЕТ ДОСТУПА !!!"});var s=_jsonwebtoken.default.verify(o,secret);if(s.role!==n)return t.status(403).json({message:"НЕТ ДОСТУПА !!!"});e.user=s,r()}catch(e){t.status(401).json({message:"НЕТ ДОСТУПА !!!"})}}}
//# sourceMappingURL=checkRoleMiddleware.min.js.map
